Clarifying Questions & Assumptions
Before diving into the design, it's good practice to clarify any ambiguities. Here are my thoughts and assumed answers for this exercise:

IDs (User, Restaurant, Order, Dish): Will these be simple auto-incrementing integers, UUIDs, or strings?

Assumption: For an in-memory system, using simple string UUIDs (e.g., generated by Python's uuid module) for user_id, restaurant_id, and order_id is robust and easy to implement. Dish names will act as their unique identifier within a menu.

Dish Quantity: Is it always a positive integer? Can it be zero or negative?

Assumption: Positive integers only. Orders with zero or negative quantities for any dish should be rejected.

Search Query (search_restaurants): The problem states "simple string match for now." Does this mean case-sensitive or insensitive? Should it match restaurant name, description, or cuisine?

Assumption: Case-insensitive substring match against the restaurant's name. Proximity will be ignored for simplicity.

Order Status Transitions: The problem lists a chain of valid transitions. Are these strictly enforced, or can a restaurant jump steps (e.g., PENDING directly to OUT_FOR_DELIVERY)?

Assumption: Strictly enforced transitions. Any invalid transition attempt should raise an error.

Cancelling Orders: Can an order be cancelled at any status, or only up to a certain point (e.g., PREPARING)?

Assumption: An order can only be CANCELLED from PENDING or ACCEPTED states. Once PREPARING or later, it cannot be cancelled via the system (simulating the food being made).

Menu Management: Can restaurants update their menus dynamically (add/remove dishes, change prices)?

Assumption: For this problem, assume menus are static once the restaurant is registered. We won't implement methods for dynamic menu updates to keep scope manageable.

Delivery Logic: Is there any actual delivery driver assignment or location tracking?

Assumption: No actual delivery logic. OUT_FOR_DELIVERY and DELIVERED are just status changes, not tied to a driver entity or complex routing.